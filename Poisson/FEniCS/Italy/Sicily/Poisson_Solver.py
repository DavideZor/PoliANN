from fenics import * 
from mshr import *
import pylab as plt

f = Constant(1.0)

g_D = Constant(0.0)

degree = 1 #Linear finite elements

resolution = 100

# domain_vertices = [Point(5.4206, 14.494), Point(5.415, 14.4918), Point(5.401, 14.4786), Point(5.3873999999999995, 14.472000000000001), Point(5.3832, 14.4682), Point(5.3754, 14.463), Point(5.348000000000001, 14.4534), Point(5.3378000000000005, 14.4516), Point(5.3316, 14.451799999999999), Point(5.325800000000001, 14.453), Point(5.3216, 14.456199999999999), Point(5.32, 14.462), Point(5.322, 14.4726), Point(5.3208, 14.4772), Point(5.3188, 14.4772), Point(5.32, 14.475800000000001), Point(5.3188, 14.472199999999999), Point(5.3184, 14.4712), Point(5.319000000000001, 14.4702), Point(5.32, 14.4668), Point(5.3069999999999995, 14.440999999999999), Point(5.298, 14.429), Point(5.2788, 14.4224), Point(5.2728, 14.419), Point(5.2666, 14.416599999999999), Point(5.26, 14.418), Point(5.258000000000001, 14.42), Point(5.2546, 14.425600000000001), Point(5.253, 14.427000000000001), Point(5.2496, 14.4278), Point(5.2386, 14.427000000000001), Point(5.2296, 14.43), Point(5.2254000000000005, 14.4304), Point(5.223, 14.4322), Point(5.2168, 14.4404), Point(5.2134, 14.4422), Point(5.203600000000001, 14.443), Point(5.200200000000001, 14.4422), Point(5.197000000000001, 14.4408), Point(5.192, 14.4376), Point(5.1656, 14.4308), Point(5.158399999999999, 14.4304), Point(5.147, 14.4314), Point(5.143, 14.4296), Point(5.1297999999999995, 14.413400000000001), Point(5.12, 14.4038), Point(5.1084, 14.395800000000001), Point(5.0656, 14.3794), Point(5.049, 14.376199999999999), Point(5.037599999999999, 14.3816), Point(5.0212, 14.372799999999998), Point(5.0026, 14.367799999999999), Point(4.9822, 14.366399999999999), Point(4.9398, 14.3726), Point(4.9292, 14.3698), Point(4.924, 14.3692), Point(4.9159999999999995, 14.3704), Point(4.908799999999999, 14.373199999999999), Point(4.894, 14.3816), Point(4.8894, 14.376800000000001), Point(4.865399999999999, 14.3726), Point(4.8606, 14.3694), Point(4.8564, 14.3654), Point(4.8514, 14.3618), Point(4.837, 14.3584), Point(4.8216, 14.350000000000001), Point(4.8138, 14.348), Point(4.7916, 14.351400000000002), Point(4.784, 14.351199999999999), Point(4.784800000000001, 14.352599999999999), Point(4.785, 14.3532), Point(4.7864, 14.3544), Point(4.7814, 14.357), Point(4.7652, 14.3602), Point(4.7552, 14.366399999999999), Point(4.7428, 14.376999999999999), Point(4.7324, 14.3816), Point(4.729, 14.3846), Point(4.7266, 14.3896), Point(4.7261999999999995, 14.3938), Point(4.7268, 14.401399999999999), Point(4.7172, 14.4088), Point(4.6744, 14.4054), Point(4.6694, 14.418), Point(4.668200000000001, 14.4222), Point(4.6676, 14.4364), Point(4.6655999999999995, 14.4394), Point(4.6524, 14.4486), Point(4.6516, 14.4506), Point(4.6514, 14.4536), Point(4.6506, 14.4564), Point(4.649, 14.4576), Point(4.646199999999999, 14.457199999999998), Point(4.6414, 14.4548), Point(4.6346, 14.453199999999999), Point(4.6306, 14.4508), Point(4.6266, 14.4496), Point(4.6212, 14.4516), Point(4.6182, 14.441600000000001), Point(4.6102, 14.437800000000001), Point(4.6004000000000005, 14.437999999999999), Point(4.5926, 14.4394), Point(4.5806000000000004, 14.4444), Point(4.5772, 14.4452), Point(4.5729999999999995, 14.443999999999999), Point(4.5692, 14.440999999999999), Point(4.567, 14.437199999999999), Point(4.569, 14.4334), Point(4.557, 14.422600000000001), Point(4.5576, 14.4186), Point(4.561, 14.4144), Point(4.5616, 14.4102), Point(4.5622, 14.4048), Point(4.5628, 14.4022), Point(4.5622, 14.400200000000002), Point(4.5592, 14.3968), Point(4.5474, 14.3874), Point(4.5184, 14.374400000000001), Point(4.5034, 14.3722), Point(4.4924, 14.378599999999999), Point(4.492, 14.3826), Point(4.4879999999999995, 14.3858), Point(4.478, 14.390799999999999), Point(4.4744, 14.394400000000001), Point(4.4648, 14.4116), Point(4.4562, 14.431799999999999), Point(4.4544, 14.44), Point(4.4504, 14.4406), Point(4.4464, 14.44), Point(4.4441999999999995, 14.4452), Point(4.44, 14.4376), Point(4.4416, 14.4264), Point(4.442, 14.4156), Point(4.4348, 14.4088), Point(4.4304, 14.409400000000002), Point(4.424799999999999, 14.4112), Point(4.42, 14.4114), Point(4.418, 14.407399999999999), Point(4.4162, 14.4004), Point(4.4118, 14.395), Point(4.4012, 14.3874), Point(4.39, 14.3916), Point(4.3806, 14.383999999999999), Point(4.3716, 14.3736), Point(4.3608, 14.3692), Point(4.3648, 14.364799999999999), Point(4.3644, 14.3584), Point(4.3622, 14.351199999999999), Point(4.36, 14.3394), Point(4.3518, 14.322600000000001), Point(4.351, 14.3218), Point(4.3508000000000004, 14.321200000000001), Point(4.3512, 14.318200000000001), Point(4.351999999999999, 14.3142), Point(4.3552, 14.3092), Point(4.3558, 14.3072), Point(4.3556, 14.3034), Point(4.3536, 14.2952), Point(4.353, 14.2948), Point(4.3504, 14.2826), Point(4.3512, 14.2814), Point(4.349600000000001, 14.279599999999999), Point(4.3444, 14.276599999999998), Point(4.344, 14.2784), Point(4.338, 14.275400000000001), Point(4.3378, 14.27), Point(4.341, 14.2638), Point(4.3452, 14.2586), Point(4.348, 14.253599999999999), Point(4.349, 14.2482), Point(4.349600000000001, 14.2424), Point(4.3512, 14.235800000000001), Point(4.3544, 14.2284), Point(4.3594, 14.2196), Point(4.3654, 14.212), Point(4.3716, 14.2088), Point(4.3854, 14.2086), Point(4.3904, 14.206000000000001), Point(4.3964, 14.1998), Point(4.4108, 14.175199999999998), Point(4.4190000000000005, 14.1676), Point(4.4324, 14.1666), Point(4.461399999999999, 14.1716), Point(4.4898, 14.1726), Point(4.5178, 14.1692), Point(4.5288, 14.164399999999999), Point(4.5378, 14.154599999999999), Point(4.5394000000000005, 14.151), Point(4.541399999999999, 14.142), Point(4.5438, 14.138), Point(4.547, 14.136), Point(4.5506, 14.136800000000001), Point(4.5558, 14.1394), Point(4.5986, 14.1334), Point(4.6004000000000005, 14.132), Point(4.604, 14.1256), Point(4.6058, 14.1244), Point(4.6098, 14.1232), Point(4.6126000000000005, 14.120600000000001), Point(4.6166, 14.115200000000002), Point(4.6242, 14.1108), Point(4.6262, 14.109), Point(4.6348, 14.092199999999998), Point(4.6388, 14.0902), Point(4.6432, 14.088799999999999), Point(4.6466, 14.0866), Point(4.653, 14.080200000000001), Point(4.6678, 14.0714), Point(4.6850000000000005, 14.0574), Point(4.6958, 14.0506), Point(4.7084, 14.046000000000001), Point(4.7244, 14.043399999999998), Point(4.7366, 14.0396), Point(4.7468, 14.0322), Point(4.7764, 14.002600000000001), Point(4.7878, 13.994800000000001), Point(4.8002, 13.9894), Point(4.8152, 13.9862), Point(4.8286, 13.9808), Point(4.85, 13.963799999999999), Point(4.865399999999999, 13.9618), Point(4.869, 13.963000000000001), Point(4.8756, 13.967), Point(4.8786000000000005, 13.968), Point(4.9178, 13.9712), Point(4.931, 13.968799999999998), Point(4.9597999999999995, 13.955200000000001), Point(4.9841999999999995, 13.939), Point(5.016, 13.908000000000001), Point(5.0246, 13.895800000000001), Point(5.053, 13.834599999999998), Point(5.057, 13.8296), Point(5.0844000000000005, 13.823), Point(5.0902, 13.824399999999999), Point(5.0964, 13.8204), Point(5.117000000000001, 13.8124), Point(5.1214, 13.808), Point(5.1258, 13.8002), Point(5.146800000000001, 13.7972), Point(5.1526000000000005, 13.791599999999999), Point(5.157, 13.7932), Point(5.1578, 13.7922), Point(5.1594, 13.788599999999999), Point(5.182600000000001, 13.8004), Point(5.194800000000001, 13.8022), Point(5.2076, 13.797600000000001), Point(5.221, 13.788), Point(5.2298, 13.784), Point(5.2338, 13.787199999999999), Point(5.2352, 13.789800000000001), Point(5.2383999999999995, 13.790199999999999), Point(5.2434, 13.788599999999999), Point(5.2476, 13.7862), Point(5.2502, 13.7836), Point(5.2552, 13.776399999999999), Point(5.2616, 13.771199999999999), Point(5.268800000000001, 13.7692), Point(5.276, 13.7714), Point(5.2828, 13.777999999999999), Point(5.2829999999999995, 13.7836), Point(5.276800000000001, 13.8094), Point(5.2706, 13.8234), Point(5.268800000000001, 13.832199999999998), Point(5.2732, 13.836200000000002), Point(5.2736, 13.8412), Point(5.2912, 13.8866), Point(5.297, 13.8954), Point(5.3044, 13.899), Point(5.3098, 13.9008), Point(5.3152, 13.904399999999999), Point(5.3214, 13.9076), Point(5.3296, 13.908000000000001), Point(5.3296, 13.9112), Point(5.328, 13.914200000000001), Point(5.3288, 13.9152), Point(5.332, 13.917), Point(5.3296, 13.919999999999998), Point(5.3418, 13.9268), Point(5.3438, 13.9276), Point(5.3456, 13.9252), Point(5.349399999999999, 13.923399999999999), Point(5.352, 13.9248), Point(5.351, 13.9318), Point(5.348000000000001, 13.9374), Point(5.345, 13.939), Point(5.3378000000000005, 13.9382), Point(5.335, 13.940999999999999), Point(5.3344000000000005, 13.9464), Point(5.3364, 13.95), Point(5.3416, 13.947000000000001), Point(5.343400000000001, 13.9576), Point(5.3418, 13.964), Point(5.3368, 13.9672), Point(5.3284, 13.968), Point(5.322, 13.971400000000001), Point(5.316800000000001, 13.9788), Point(5.316, 13.985199999999999), Point(5.3224, 13.9862), Point(5.3224, 13.9892), Point(5.3174, 13.991800000000001), Point(5.311599999999999, 13.9876), Point(5.304, 13.997), Point(5.300000000000001, 14.0106), Point(5.305400000000001, 14.0194), Point(5.3034, 14.024799999999999), Point(5.3076, 14.0268), Point(5.311399999999999, 14.0268), Point(5.313400000000001, 14.0238), Point(5.312799999999999, 14.016200000000001), Point(5.3158, 14.020600000000002), Point(5.318199999999999, 14.0256), Point(5.3214, 14.0276), Point(5.3271999999999995, 14.0222), Point(5.324, 14.032599999999999), Point(5.3186, 14.04), Point(5.3118, 14.0446), Point(5.2988, 14.047), Point(5.2746, 14.0608), Point(5.2722, 14.0642), Point(5.2698, 14.070400000000001), Point(5.268199999999999, 14.0778), Point(5.2672, 14.1212), Point(5.268000000000001, 14.129199999999999), Point(5.2698, 14.1366), Point(5.2764, 14.1488), Point(5.293200000000001, 14.1688), Point(5.2984, 14.185), Point(5.3004, 14.1944), Point(5.304600000000001, 14.2074), Point(5.305400000000001, 14.2164), Point(5.3066, 14.220600000000001), Point(5.311399999999999, 14.2256), Point(5.312799999999999, 14.2302), Point(5.312200000000001, 14.235199999999999), Point(5.3086, 14.2434), Point(5.308000000000001, 14.2482), Point(5.3104, 14.254199999999999), Point(5.320200000000001, 14.269400000000001), Point(5.329000000000001, 14.276599999999998), Point(5.335, 14.2858), Point(5.3416, 14.299800000000001), Point(5.373, 14.3492), Point(5.4106, 14.397400000000001), Point(5.42, 14.4204), Point(5.436999999999999, 14.4486), Point(5.4314, 14.4484), Point(5.4326, 14.4548), Point(5.434799999999999, 14.4604), Point(5.4398, 14.4664), Point(5.454, 14.475800000000001), Point(5.4574, 14.4756), Point(5.4601999999999995, 14.476199999999999), Point(5.4622, 14.478200000000001), Point(5.4634, 14.482), Point(5.4510000000000005, 14.484200000000001), Point(5.4312000000000005, 14.493)]

domain_vertices = [Point(27.102999999999998, 72.47), Point(27.075, 72.45899999999999), Point(27.005000000000003, 72.393), Point(26.937, 72.36), Point(26.916, 72.341), Point(26.877000000000002, 72.315), Point(26.740000000000002, 72.26700000000001), Point(26.689, 72.258), Point(26.657999999999998, 72.259), Point(26.629, 72.265), Point(26.607999999999997, 72.28099999999999), Point(26.6, 72.31), Point(26.61, 72.363), Point(26.604, 72.386), Point(26.594, 72.386), Point(26.6, 72.379), Point(26.594, 72.361), Point(26.592, 72.356), Point(26.595000000000002, 72.351), Point(26.6, 72.334), Point(26.534999999999997, 72.205), Point(26.490000000000002, 72.14500000000001), Point(26.394000000000002, 72.112), Point(26.363999999999997, 72.095), Point(26.333000000000002, 72.083), Point(26.3, 72.09), Point(26.290000000000003, 72.1), Point(26.273000000000003, 72.128), Point(26.265, 72.135), Point(26.247999999999998, 72.139), Point(26.192999999999998, 72.135), Point(26.148, 72.15), Point(26.127, 72.152), Point(26.115, 72.161), Point(26.084000000000003, 72.202), Point(26.067, 72.211), Point(26.018, 72.21499999999999), Point(26.001, 72.211), Point(25.985000000000003, 72.20400000000001), Point(25.96, 72.188), Point(25.828, 72.154), Point(25.791999999999998, 72.152), Point(25.735000000000003, 72.15700000000001), Point(25.715, 72.148), Point(25.649, 72.06700000000001), Point(25.6, 72.019), Point(25.541999999999998, 71.979), Point(25.328, 71.897), Point(25.245, 71.881), Point(25.188, 71.908), Point(25.106, 71.86399999999999), Point(25.013, 71.839), Point(24.911, 71.832), Point(24.698999999999998, 71.863), Point(24.646, 71.84899999999999), Point(24.62, 71.846), Point(24.58, 71.852), Point(24.544, 71.866), Point(24.47, 71.908), Point(24.447, 71.884), Point(24.326999999999998, 71.863), Point(24.303, 71.84700000000001), Point(24.282, 71.827), Point(24.257, 71.809), Point(24.185000000000002, 71.792), Point(24.108, 71.75), Point(24.069, 71.74000000000001), Point(23.958, 71.757), Point(23.919999999999998, 71.756), Point(23.924, 71.763), Point(23.925, 71.76599999999999), Point(23.932000000000002, 71.772), Point(23.907, 71.785), Point(23.826, 71.801), Point(23.776, 71.832), Point(23.714, 71.885), Point(23.662, 71.908), Point(23.645, 71.923), Point(23.633000000000003, 71.94800000000001), Point(23.631, 71.96900000000001), Point(23.634, 72.007), Point(23.586, 72.044), Point(23.372, 72.027), Point(23.347, 72.09), Point(23.341, 72.111), Point(23.338, 72.182), Point(23.328, 72.197), Point(23.262, 72.243), Point(23.258000000000003, 72.253), Point(23.257, 72.268), Point(23.253, 72.282), Point(23.244999999999997, 72.288), Point(23.230999999999998, 72.286), Point(23.207, 72.274), Point(23.173, 72.26599999999999), Point(23.153000000000002, 72.25399999999999), Point(23.133, 72.248), Point(23.105999999999998, 72.258), Point(23.091, 72.208), Point(23.051, 72.18900000000001), Point(23.002, 72.19), Point(22.963, 72.197), Point(22.903000000000002, 72.222), Point(22.886, 72.226), Point(22.865, 72.22), Point(22.846, 72.205), Point(22.835, 72.18599999999999), Point(22.845, 72.167), Point(22.785, 72.113), Point(22.788, 72.09299999999999), Point(22.805, 72.072), Point(22.808, 72.051), Point(22.811, 72.024), Point(22.814, 72.011), Point(22.811, 72.001), Point(22.796, 71.98400000000001), Point(22.737, 71.937), Point(22.592000000000002, 71.872), Point(22.517, 71.86099999999999), Point(22.462, 71.893), Point(22.46, 71.91300000000001), Point(22.439999999999998, 71.929), Point(22.39, 71.954), Point(22.372, 71.97200000000001), Point(22.323999999999998, 72.05799999999999), Point(22.281000000000002, 72.15899999999999), Point(22.272, 72.2), Point(22.252, 72.20299999999999), Point(22.232, 72.2), Point(22.221, 72.226), Point(22.2, 72.188), Point(22.208, 72.13199999999999), Point(22.21, 72.078), Point(22.174, 72.044), Point(22.152, 72.04700000000001), Point(22.124, 72.056), Point(22.1, 72.057), Point(22.09, 72.03699999999999), Point(22.081, 72.002), Point(22.059, 71.975), Point(22.006, 71.937), Point(21.95, 71.958), Point(21.903, 71.92), Point(21.858, 71.868), Point(21.804000000000002, 71.846), Point(21.823999999999998, 71.824), Point(21.822, 71.792), Point(21.811, 71.756), Point(21.8, 71.697), Point(21.759, 71.613), Point(21.755, 71.609), Point(21.754, 71.60600000000001), Point(21.756, 71.59100000000001), Point(21.759999999999998, 71.571), Point(21.776, 71.54599999999999), Point(21.779, 71.536), Point(21.778, 71.517), Point(21.768, 71.476), Point(21.765, 71.474), Point(21.752, 71.41300000000001), Point(21.756, 71.407), Point(21.748, 71.398), Point(21.722, 71.383), Point(21.72, 71.392), Point(21.69, 71.377), Point(21.689, 71.35000000000001), Point(21.705, 71.319), Point(21.726, 71.29299999999999), Point(21.740000000000002, 71.268), Point(21.745, 71.241), Point(21.748, 71.212), Point(21.756, 71.179), Point(21.772, 71.14200000000001), Point(21.797, 71.098), Point(21.826999999999998, 71.06), Point(21.858, 71.044), Point(21.927, 71.043), Point(21.951999999999998, 71.03), Point(21.982, 70.999), Point(22.054000000000002, 70.87599999999999), Point(22.095000000000002, 70.838), Point(22.162000000000003, 70.833), Point(22.307, 70.858), Point(22.448999999999998, 70.863), Point(22.589000000000002, 70.846), Point(22.644000000000002, 70.822), Point(22.689, 70.773), Point(22.697, 70.755), Point(22.707, 70.71), Point(22.719, 70.69), Point(22.735, 70.67999999999999), Point(22.753, 70.684), Point(22.779, 70.697), Point(22.993, 70.667), Point(23.002, 70.66), Point(23.02, 70.628), Point(23.029, 70.622), Point(23.049, 70.616), Point(23.063, 70.60300000000001), Point(23.083000000000002, 70.57600000000001), Point(23.121, 70.55399999999999), Point(23.131, 70.545), Point(23.174, 70.461), Point(23.194, 70.451), Point(23.216, 70.44399999999999), Point(23.233, 70.433), Point(23.265, 70.401), Point(23.339, 70.357), Point(23.425, 70.287), Point(23.479, 70.253), Point(23.541999999999998, 70.23), Point(23.622, 70.217), Point(23.683, 70.19800000000001), Point(23.733999999999998, 70.161), Point(23.882, 70.013), Point(23.939, 69.974), Point(24.001, 69.947), Point(24.076, 69.931), Point(24.143, 69.904), Point(24.25, 69.819), Point(24.326999999999998, 69.809), Point(24.345, 69.815), Point(24.378, 69.83500000000001), Point(24.393, 69.84), Point(24.589, 69.856), Point(24.654999999999998, 69.844), Point(24.799, 69.77600000000001), Point(24.921, 69.695), Point(25.080000000000002, 69.54), Point(25.123, 69.479), Point(25.264999999999997, 69.173), Point(25.285000000000004, 69.148), Point(25.422, 69.11500000000001), Point(25.451, 69.122), Point(25.482, 69.102), Point(25.585, 69.062), Point(25.607000000000003, 69.04), Point(25.629, 69.001), Point(25.734, 68.986), Point(25.763, 68.958), Point(25.785000000000004, 68.96600000000001), Point(25.789, 68.961), Point(25.796999999999997, 68.943), Point(25.913000000000004, 69.002), Point(25.974000000000004, 69.011), Point(26.038, 68.988), Point(26.105, 68.94), Point(26.149, 68.92), Point(26.168999999999997, 68.93599999999999), Point(26.176, 68.949), Point(26.192, 68.951), Point(26.217000000000002, 68.943), Point(26.238, 68.931), Point(26.251, 68.918), Point(26.276, 68.882), Point(26.308, 68.856), Point(26.344, 68.84599999999999), Point(26.38, 68.857), Point(26.413999999999998, 68.89), Point(26.415, 68.918), Point(26.384, 69.047), Point(26.352999999999998, 69.11699999999999), Point(26.344, 69.161), Point(26.366, 69.181), Point(26.368000000000002, 69.206), Point(26.456000000000003, 69.433), Point(26.484999999999996, 69.477), Point(26.522000000000002, 69.49499999999999), Point(26.549, 69.504), Point(26.576, 69.52199999999999), Point(26.606999999999996, 69.538), Point(26.648, 69.54), Point(26.648, 69.556), Point(26.640000000000004, 69.571), Point(26.644000000000002, 69.57600000000001), Point(26.66, 69.585), Point(26.648, 69.6), Point(26.709, 69.634), Point(26.718999999999998, 69.638), Point(26.728, 69.626), Point(26.747, 69.61699999999999), Point(26.76, 69.624), Point(26.755000000000003, 69.659), Point(26.740000000000002, 69.687), Point(26.724999999999998, 69.695), Point(26.689, 69.691), Point(26.674999999999997, 69.705), Point(26.672, 69.732), Point(26.682, 69.75), Point(26.708, 69.735), Point(26.717000000000002, 69.788), Point(26.709, 69.82000000000001), Point(26.684, 69.836), Point(26.642, 69.84), Point(26.61, 69.857), Point(26.584000000000003, 69.894), Point(26.58, 69.926), Point(26.612000000000002, 69.931), Point(26.612000000000002, 69.946), Point(26.587, 69.959), Point(26.558, 69.938), Point(26.52, 69.985), Point(26.5, 70.053), Point(26.527, 70.097), Point(26.517000000000003, 70.124), Point(26.538, 70.134), Point(26.557, 70.134), Point(26.567, 70.119), Point(26.564, 70.081), Point(26.579000000000004, 70.10300000000001), Point(26.590999999999998, 70.128), Point(26.606999999999996, 70.138), Point(26.636, 70.111), Point(26.619999999999997, 70.163), Point(26.593, 70.19999999999999), Point(26.558999999999997, 70.223), Point(26.494, 70.235), Point(26.373, 70.304), Point(26.361, 70.321), Point(26.349, 70.352), Point(26.340999999999998, 70.389), Point(26.336, 70.60600000000001), Point(26.340000000000003, 70.646), Point(26.349, 70.68299999999999), Point(26.382, 70.744), Point(26.466, 70.844), Point(26.491999999999997, 70.92500000000001), Point(26.502, 70.97200000000001), Point(26.523000000000003, 71.03699999999999), Point(26.527, 71.082), Point(26.533, 71.10300000000001), Point(26.557, 71.128), Point(26.564, 71.151), Point(26.561, 71.17599999999999), Point(26.543, 71.217), Point(26.540000000000003, 71.241), Point(26.552, 71.271), Point(26.601000000000003, 71.34700000000001), Point(26.645000000000003, 71.383), Point(26.674999999999997, 71.429), Point(26.708, 71.499), Point(26.865, 71.746), Point(27.053, 71.987), Point(27.1, 72.102), Point(27.185, 72.243), Point(27.156999999999996, 72.24199999999999), Point(27.162999999999997, 72.274), Point(27.174, 72.30199999999999), Point(27.199, 72.332), Point(27.27, 72.379), Point(27.287, 72.378), Point(27.301, 72.381), Point(27.311000000000003, 72.391), Point(27.317000000000004, 72.41), Point(27.255000000000003, 72.421), Point(27.156000000000002, 72.465)]

# domain_vertices = [Point(54.205999999999996, 144.94), Point(54.15, 144.91799999999998), Point(54.010000000000005, 144.786), Point(53.874, 144.72), Point(53.832, 144.682), Point(53.754000000000005, 144.63), Point(53.480000000000004, 144.53400000000002), Point(53.378, 144.516), Point(53.315999999999995, 144.518), Point(53.258, 144.53), Point(53.215999999999994, 144.56199999999998), Point(53.2, 144.62), Point(53.22, 144.726), Point(53.208, 144.772), Point(53.188, 144.772), Point(53.2, 144.758), Point(53.188, 144.722), Point(53.184, 144.712), Point(53.190000000000005, 144.702), Point(53.2, 144.668), Point(53.06999999999999, 144.41), Point(52.980000000000004, 144.29000000000002), Point(52.788000000000004, 144.224), Point(52.727999999999994, 144.19), Point(52.666000000000004, 144.166), Point(52.6, 144.18), Point(52.580000000000005, 144.2), Point(52.54600000000001, 144.256), Point(52.53, 144.27), Point(52.495999999999995, 144.278), Point(52.385999999999996, 144.27), Point(52.296, 144.3), Point(52.254, 144.304), Point(52.23, 144.322), Point(52.168000000000006, 144.404), Point(52.134, 144.422), Point(52.036, 144.42999999999998), Point(52.002, 144.422), Point(51.970000000000006, 144.40800000000002), Point(51.92, 144.376), Point(51.656, 144.308), Point(51.583999999999996, 144.304), Point(51.470000000000006, 144.31400000000002), Point(51.43, 144.296), Point(51.298, 144.13400000000001), Point(51.2, 144.038), Point(51.083999999999996, 143.958), Point(50.656, 143.794), Point(50.49, 143.762), Point(50.376, 143.816), Point(50.212, 143.72799999999998), Point(50.026, 143.678), Point(49.822, 143.664), Point(49.397999999999996, 143.726), Point(49.292, 143.69799999999998), Point(49.24, 143.692), Point(49.16, 143.704), Point(49.088, 143.732), Point(48.94, 143.816), Point(48.894, 143.768), Point(48.653999999999996, 143.726), Point(48.606, 143.69400000000002), Point(48.564, 143.654), Point(48.514, 143.618), Point(48.370000000000005, 143.584), Point(48.216, 143.5), Point(48.138, 143.48000000000002), Point(47.916, 143.514), Point(47.839999999999996, 143.512), Point(47.848, 143.526), Point(47.85, 143.53199999999998), Point(47.864000000000004, 143.544), Point(47.814, 143.57), Point(47.652, 143.602), Point(47.552, 143.664), Point(47.428, 143.77), Point(47.324, 143.816), Point(47.29, 143.846), Point(47.266000000000005, 143.89600000000002), Point(47.262, 143.93800000000002), Point(47.268, 144.014), Point(47.172, 144.088), Point(46.744, 144.054), Point(46.694, 144.18), Point(46.682, 144.222), Point(46.676, 144.364), Point(46.656, 144.394), Point(46.524, 144.486), Point(46.516000000000005, 144.506), Point(46.514, 144.536), Point(46.506, 144.564), Point(46.489999999999995, 144.576), Point(46.461999999999996, 144.572), Point(46.414, 144.548), Point(46.346, 144.53199999999998), Point(46.306000000000004, 144.50799999999998), Point(46.266, 144.496), Point(46.211999999999996, 144.516), Point(46.182, 144.416), Point(46.102, 144.37800000000001), Point(46.004, 144.38), Point(45.926, 144.394), Point(45.806000000000004, 144.444), Point(45.772, 144.452), Point(45.73, 144.44), Point(45.692, 144.41), Point(45.67, 144.37199999999999), Point(45.69, 144.334), Point(45.57, 144.226), Point(45.576, 144.18599999999998), Point(45.61, 144.144), Point(45.616, 144.102), Point(45.622, 144.048), Point(45.628, 144.022), Point(45.622, 144.002), Point(45.592, 143.96800000000002), Point(45.474, 143.874), Point(45.184000000000005, 143.744), Point(45.034, 143.72199999999998), Point(44.924, 143.786), Point(44.92, 143.82600000000002), Point(44.879999999999995, 143.858), Point(44.78, 143.908), Point(44.744, 143.94400000000002), Point(44.647999999999996, 144.11599999999999), Point(44.562000000000005, 144.31799999999998), Point(44.544, 144.4), Point(44.504, 144.40599999999998), Point(44.464, 144.4), Point(44.442, 144.452), Point(44.4, 144.376), Point(44.416, 144.26399999999998), Point(44.42, 144.156), Point(44.348, 144.088), Point(44.304, 144.09400000000002), Point(44.248, 144.112), Point(44.2, 144.114), Point(44.18, 144.07399999999998), Point(44.162, 144.004), Point(44.118, 143.95), Point(44.012, 143.874), Point(43.9, 143.916), Point(43.806, 143.84), Point(43.716, 143.736), Point(43.608000000000004, 143.692), Point(43.647999999999996, 143.648), Point(43.644, 143.584), Point(43.622, 143.512), Point(43.6, 143.394), Point(43.518, 143.226), Point(43.51, 143.218), Point(43.508, 143.21200000000002), Point(43.512, 143.18200000000002), Point(43.519999999999996, 143.142), Point(43.552, 143.09199999999998), Point(43.558, 143.072), Point(43.556, 143.034), Point(43.536, 142.952), Point(43.53, 142.948), Point(43.504, 142.82600000000002), Point(43.512, 142.814), Point(43.496, 142.796), Point(43.444, 142.766), Point(43.44, 142.784), Point(43.38, 142.754), Point(43.378, 142.70000000000002), Point(43.41, 142.638), Point(43.452, 142.58599999999998), Point(43.480000000000004, 142.536), Point(43.49, 142.482), Point(43.496, 142.424), Point(43.512, 142.358), Point(43.544, 142.28400000000002), Point(43.594, 142.196), Point(43.653999999999996, 142.12), Point(43.716, 142.088), Point(43.854, 142.086), Point(43.903999999999996, 142.06), Point(43.964, 141.998), Point(44.108000000000004, 141.75199999999998), Point(44.190000000000005, 141.676), Point(44.324000000000005, 141.666), Point(44.614, 141.716), Point(44.897999999999996, 141.726), Point(45.178000000000004, 141.692), Point(45.288000000000004, 141.644), Point(45.378, 141.546), Point(45.394, 141.51), Point(45.414, 141.42), Point(45.438, 141.38), Point(45.47, 141.35999999999999), Point(45.506, 141.368), Point(45.558, 141.394), Point(45.986, 141.334), Point(46.004, 141.32), Point(46.04, 141.256), Point(46.058, 141.244), Point(46.098, 141.232), Point(46.126, 141.20600000000002), Point(46.166000000000004, 141.15200000000002), Point(46.242, 141.10799999999998), Point(46.262, 141.09), Point(46.348, 140.922), Point(46.388, 140.902), Point(46.432, 140.88799999999998), Point(46.466, 140.866), Point(46.53, 140.802), Point(46.678, 140.714), Point(46.85, 140.574), Point(46.958, 140.506), Point(47.083999999999996, 140.46), Point(47.244, 140.434), Point(47.366, 140.39600000000002), Point(47.467999999999996, 140.322), Point(47.764, 140.026), Point(47.878, 139.948), Point(48.002, 139.894), Point(48.152, 139.862), Point(48.286, 139.808), Point(48.5, 139.638), Point(48.653999999999996, 139.618), Point(48.69, 139.63), Point(48.756, 139.67000000000002), Point(48.786, 139.68), Point(49.178, 139.712), Point(49.309999999999995, 139.688), Point(49.598, 139.55200000000002), Point(49.842, 139.39), Point(50.160000000000004, 139.08), Point(50.246, 138.958), Point(50.529999999999994, 138.346), Point(50.57000000000001, 138.296), Point(50.844, 138.23000000000002), Point(50.902, 138.244), Point(50.964, 138.204), Point(51.17, 138.124), Point(51.214000000000006, 138.08), Point(51.258, 138.002), Point(51.468, 137.972), Point(51.526, 137.916), Point(51.57000000000001, 137.93200000000002), Point(51.578, 137.922), Point(51.593999999999994, 137.886), Point(51.82600000000001, 138.004), Point(51.94800000000001, 138.022), Point(52.076, 137.976), Point(52.21, 137.88), Point(52.298, 137.84), Point(52.337999999999994, 137.87199999999999), Point(52.352, 137.898), Point(52.384, 137.902), Point(52.434000000000005, 137.886), Point(52.476, 137.862), Point(52.502, 137.836), Point(52.552, 137.764), Point(52.616, 137.712), Point(52.688, 137.69199999999998), Point(52.76, 137.714), Point(52.827999999999996, 137.78), Point(52.83, 137.836), Point(52.768, 138.094), Point(52.705999999999996, 138.23399999999998), Point(52.688, 138.322), Point(52.732, 138.362), Point(52.736000000000004, 138.412), Point(52.912000000000006, 138.866), Point(52.96999999999999, 138.954), Point(53.044000000000004, 138.98999999999998), Point(53.098, 139.008), Point(53.152, 139.04399999999998), Point(53.21399999999999, 139.076), Point(53.296, 139.08), Point(53.296, 139.112), Point(53.28000000000001, 139.142), Point(53.288000000000004, 139.15200000000002), Point(53.32, 139.17), Point(53.296, 139.2), Point(53.418, 139.268), Point(53.437999999999995, 139.276), Point(53.456, 139.252), Point(53.494, 139.23399999999998), Point(53.52, 139.248), Point(53.510000000000005, 139.318), Point(53.480000000000004, 139.374), Point(53.449999999999996, 139.39), Point(53.378, 139.382), Point(53.349999999999994, 139.41), Point(53.344, 139.464), Point(53.364, 139.5), Point(53.416, 139.47), Point(53.434000000000005, 139.576), Point(53.418, 139.64000000000001), Point(53.368, 139.672), Point(53.284, 139.68), Point(53.22, 139.714), Point(53.168000000000006, 139.788), Point(53.16, 139.852), Point(53.224000000000004, 139.862), Point(53.224000000000004, 139.892), Point(53.174, 139.918), Point(53.116, 139.876), Point(53.04, 139.97), Point(53.0, 140.106), Point(53.054, 140.194), Point(53.034000000000006, 140.248), Point(53.076, 140.268), Point(53.114, 140.268), Point(53.134, 140.238), Point(53.128, 140.162), Point(53.15800000000001, 140.20600000000002), Point(53.181999999999995, 140.256), Point(53.21399999999999, 140.276), Point(53.272, 140.222), Point(53.239999999999995, 140.326), Point(53.186, 140.39999999999998), Point(53.117999999999995, 140.446), Point(52.988, 140.47), Point(52.746, 140.608), Point(52.722, 140.642), Point(52.698, 140.704), Point(52.681999999999995, 140.778), Point(52.672, 141.21200000000002), Point(52.68000000000001, 141.292), Point(52.698, 141.36599999999999), Point(52.764, 141.488), Point(52.932, 141.688), Point(52.983999999999995, 141.85000000000002), Point(53.004, 141.94400000000002), Point(53.04600000000001, 142.07399999999998), Point(53.054, 142.164), Point(53.066, 142.20600000000002), Point(53.114, 142.256), Point(53.128, 142.302), Point(53.122, 142.35199999999998), Point(53.086, 142.434), Point(53.080000000000005, 142.482), Point(53.104, 142.542), Point(53.202000000000005, 142.69400000000002), Point(53.290000000000006, 142.766), Point(53.349999999999994, 142.858), Point(53.416, 142.998), Point(53.73, 143.492), Point(54.106, 143.974), Point(54.2, 144.204), Point(54.37, 144.486), Point(54.31399999999999, 144.48399999999998), Point(54.32599999999999, 144.548), Point(54.348, 144.60399999999998), Point(54.398, 144.664), Point(54.54, 144.758), Point(54.574, 144.756), Point(54.602, 144.762), Point(54.62200000000001, 144.782), Point(54.63400000000001, 144.82), Point(54.510000000000005, 144.842), Point(54.312000000000005, 144.93)]

domain = Polygon(domain_vertices)

mesh = generate_mesh(domain, resolution)

plt.rcParams.update({
    "text.usetex": True,
    "font.family": "sans-serif",
    "font.sans-serif": ["Helvetica"]})

fig = plot(mesh, title='Sicilian discretization')
plt.grid(fig, linewidth = 0.1)
plt.xlabel('$x$')
plt.ylabel('$y$')

def boundary(x, on_boundary):
  return on_boundary

V = FunctionSpace(mesh, 'CG', degree)

bc = DirichletBC(V, g_D, boundary)

u = TrialFunction(V)
v = TestFunction(V)

a = (dot(grad(u), grad(v))) * dx
L = (f * v) * dx

u = Function(V)

solve(a == L, u, bc)

tit = 'FEniCS solution with N = {}'.format(Td)

plt.rcParams.update({
    "text.usetex": True,
    "font.family": "sans-serif",
    "font.sans-serif": ["Helvetica"]})

fig = plot(u, cmap = 'jet', title = tit)
plt.grid(fig, linewidth = 0.1)
plt.colorbar(fig)
plt.xlabel('$x$')
plt.ylabel('$y$')

vtkfile = File('Velocity.pvd')
vtkfile << u

with open("FEniCSPoissonSicily.txt", "w") as txt_file:
    for line in range(len(x_coord)):
      txt_file.write('{}, {}, {};'.format(x_coord[line], y_coord[line], u_array[line]) + "\n")
